process ISO = {        // Here we assume that input is already in reco format.
	untracked PSet opt = {
	untracked bool makeTriggerResults = true  # default is false
        vstring listOfTriggers = {"*" } # must be given if makeTriggerResults is true
        		}
	untracked PSet maxEvents = {untracked int32 input = 100}
  	source = PoolSource {
    	untracked vstring fileNames = {
#'/store/RelVal/2007/8/13/RelVal-QCD_Pt_80_120-1186989291/0007/4E9C4025-9249-DC11-8FA5-00304885ADB2.root'
#'/store/RelVal/2007/8/13/RelVal-QCD_Pt_80_120-1186989291/0007/5ECAAB3F-9249-DC11-BDA7-00304885AB90.root',
#'/store/RelVal/2007/8/13/RelVal-QCD_Pt_80_120-1186989291/0008/0C933B34-9249-DC11-9323-00304885AC1C.root'
'/store/mc/2008/4/13/FastSim-QCDpt80-120_10TeV-ceballos-1208104128/0000/9695A92A-620A-DD11-8276-001617C3B69C.root'
	 }
	 untracked uint32 skipEvents = 0
	}
# include geometry and magnetic field
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
include "Geometry/CaloEventSetup/data/CaloTopology.cfi"

include "Geometry/DTGeometry/data/dtGeometry.cfi"
include "Geometry/RPCGeometry/data/rpcGeometry.cfi"
include "Geometry/CSCGeometry/data/cscGeometry.cfi"
include "Geometry/CommonDetUnit/data/bareGlobalTrackingGeometry.cfi"
include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"

include "Configuration/StandardSequences/data/Reconstruction.cff"
include "Configuration/StandardSequences/data/FakeConditions.cff"
include "Configuration/StandardSequences/data/Simulation.cff"
include "Configuration/StandardSequences/data/MixingNoPileUp.cff"
include "Configuration/StandardSequences/data/VtxSmearedGauss.cff"


# add the SteppingHelixPropagator to the EventSetup
include "TrackPropagation/SteppingHelixPropagator/data/SteppingHelixPropagatorAny.cfi"
include "TrackPropagation/SteppingHelixPropagator/data/SteppingHelixPropagatorAlong.cfi"
include "TrackPropagation/SteppingHelixPropagator/data/SteppingHelixPropagatorOpposite.cfi" 

  module IsoProd = AlCaIsoTracksProducer {
    untracked string inputTrackLabel = 'ctfWithMaterialTracks'
    include "TrackingTools/TrackAssociator/data/default.cfi"
    InputTag hoInput = horeco
    InputTag hbheInput = hbhereco
    untracked int32 histoFlag = 0
    VInputTag ecalInputs = {ecalRecHit:EcalRecHitsEB, ecalRecHit:EcalRecHitsEE }
}
  sequence seqALCARECOHcalCalIsoTrk = {IsoProd}

 module IsoTrkCalibration = HcalIsoTrkAnalyzer {
    include "TrackingTools/TrackAssociator/data/default.cfi"
        InputTag hbheInput = IsoProd:IsoTrackHBHERecHitCollection
        InputTag hoInput = IsoProd:IsoTrackHORecHitCollection
        InputTag eInput = IsoProd:IsoTrackEcalRecHitCollection
        InputTag trackInput = IsoProd:IsoTrackTracksCollection

        double associationConeSize = 0.35
        string outputFileName = "test_aug.root"
	string AxB = "3x3"

	untracked int32 noOfIterations = 10
	untracked double eventWeight = 2.
	untracked double energyMinIso = 2.
	untracked double energyMaxIso = 1000.

        bool allowMissingInputs = true 
	untracked int32 histoFlag = 0
       }
#path p = { seqALCARECOHcalCalIsoTrk, IsoTrkCalibration}
path p = { IsoTrkCalibration}
    untracked PSet options = {
    untracked bool wantSummary = true
    untracked bool makeTriggerResults = true
    vstring listOfTriggers = { "p" }
   }
   module printer = AsciiOutputModule {}
module outputEvents = PoolOutputModule
   {
        untracked vstring outputCommands =
        {
        "drop *",
#        "keep recoTracks_ctfWithMaterialTracks_*_*",
#        "keep *_ecalRecHit_*_*",
#        "keep *_hbhereco_*_*",
#        "keep *_horeco_*_*",
	"keep *_IsoProd_*_*"
	}
        untracked PSet SelectEvents = {
                vstring SelectEvents = {"p"}
        }
      untracked string fileName = "CaloRecHits_aug.root"
   }
endpath outpath = { printer, outputEvents }
}

